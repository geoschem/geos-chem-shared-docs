.. _coards-guide:

#####################################
Prepare COARDS-compliant netCDF files
#####################################

On this page we discuss how you can generate netCDF data files in the
proper format for HEMCO and GEOS-Chem:

.. _the_coards_netcdf_standard:

==========================
The COARDS netCDF standard
==========================

The `Harmonized Emissions Compionent (HEMCO)
<https://hemco.readthedocs.io>`_ reads data stored in `the netCDF file
format
<http://www.unidata.ucar.edu/software/netcdf/docs/faq.html#whatisit>`__,
which is a common data format used in atmospheric and climate
sciences. 
NetCDF files contain **data arrays** as well as **metadata**, which is
a description of the data.  

Several netCDF conventions have been developed in order to facilitate
data exchange and visualization. The `C\ ooperative O\ cean/A\ tmosphere
R\ esearch D\ ata S\ ervice (COARDS)
standard
<https://ferret.pmel.noaa.gov/Ferret/documentation/coards-netcdf-conventions>`_ 
defines regular conventions for naming dimensions as well as the
`attributes <https://www.unidata.ucar.edu/software/netcdf/docs/netcdf/Attributes.html>`__
describing the data. You will find more information about these
conventions in the sections below. HEMCO requires its input data to be
adhere to the COARDS standard.

.. _coards-guide-dims:

=================
COARDS dimensions
=================

The **dimensions** of a netCDF file define how many grid boxes there are
along a given direction. While the COARDS standard does not require any
specific n

ames for dimensions, accepted practice is to use these names
for rectilinear grids:

.. option:: time

   Specifies the number of points along the time (:literal:`T`) axis.

   The :option:`time` dimension must always be specified. When you create the
   netCDF file, you may declare :option:`time` to be
   :literal:`UNLIMITED` and then later define its size. This allows
   you to append further time points into the file later on.
   
.. option:: lev

   Specifies the number of points along the vertical level
   (:literal:`Z`) axis.

   This dimension may be omitted none of the data arrays in the netCDF
   file have a vertical dimension.

.. option:: lat

   Specifies the number of points along the latitude (:literal:`Y`)
   axis.
   
.. option:: lon

   Specifies the number of points along the longitude (:literal:`X`) axis.

.. note:: 
   
   For non-rectilinear grids (e.g. cubed-sphere), the :option:`lat`
   and :option:`lon` dimensions may be named :literal:`NY` and
   :literal:`NX` instead.

.. _coards-guide-coordvec:

=========================
COARDS coordinate vectors
=========================

**Coordinate vectors** (aka **index variables** or **axis variables**) are
1-dimensional arrays that define the values along each axis.

The only COARDS requirement for coordinate vectors are these:

#. Each coordinate vector must be given the same name as the dimension
   that is used to define it.
#. All of the values contained within a coordinate vector must be either
   monotonically increasing or monotonically decreasing.


.. _coards-guide-coordvec-time:
   
time
----

A COARDS-compliant :option:`time` coordinate vector will have these features:

.. code-block:: console

   dimensions
           time = UNLIMITED ; // (12 currently)
   . . .
   variables
           double time(time) ;
                    time:long_name = "time" ;
                    time:units = "hours since 2010-01-01 00:00:00" ;
                    time:calendar = "standard" ;
                    time:axis = "T";

.. note::

   The above was generated by the :command:`ncdump` command.
	 
As you can see, :option:`time` is an 8-byte floating point (aka
:code:`REAL*8` with 12 time points.

The :option:`time` coordinate vector has following attributes:

.. option:: time:long_name

   A detailed description of the contents of this array. This is
   usually set to :literal:`time` or :literal:`Time`. 

.. option:: time:units

   Specifies the number of hours, minutes, seconds, etc. that has
   elapsed with respect to a reference datetime :literal:`YYYY-MM-DD
   hh:mn:ss`. Set this to one of the folllowing values: 

   - :literal:`"days since YYYY-MM-DD hh:mn:ss"`
   - :literal:`"hours since YYYY-MM-DD hh:mn:ss"`
   - :literal:`"minutes since YYYY-MM-DD hh:mn:ss"`
   - :literal:`"seconds since YYYY-MM-DD hh:mn:ss"`
     
   .. tip::

      We recommend that you choose the reference datetime to correspond to
      the first time value in the file (i.e. :literal:`time(0) = 0`).

.. option:: time:calendar

   Specifies the calendar used to define the time system.  Set this to
   one of the following values: 

   .. option:: standard

      Synonym for :option:`gregorian`.	       

   .. option:: gregorian

      Selects the Gregorian calendar system.

.. option:: time:axis

   Identifies the axis :literal:`(X,Y,Z,T)` corresponding to this
   coordinate vector.  Set this to :literal:`T`. 	  

.. _coards-guide-coordvec-lev:

lev
---

A COARDS-compliant :option:`lev` coordinate vector will have these features:

.. code-block:: console

    dimensions:
            lev = 72 ;
    . . . 
    variables:
            double lev(lev) ;
                    lev:long_name = "level" ;
                    lev:units = "level" ;
                    lev:positive = "up" ;
                    lev:axis = "Z" ;

Here, :option:`lev` is an 8-byte floating point (aka
:literal:`REAL*8`) with 72 levels.   

The :option:`lev` coordinate vector has the following attributes:

.. option:: lev:long_name

   A detailed description of the contents of this array.  You may set
   this to values such as:

   - :literal:`"level"`
   - :literal:`"GEOS-Chem levels"`
   - :literal:`"Eta centers"`
   - :literal:`"Sigma centers"`

.. option:: lev:units
     
   **(Required)**  Specifies the units of vertical levels.  Set this
   to one of the following:

   - :literal:`"levels"`
   - :literal:`"eta_level"`
   - :literal:`"sigma_level"`

   .. important::

      If you set :literal:`long_name:` to :literal:`level` as well,
      then HEMCO will be able to regrid between GEOS-Chem vertical
      grids. 

.. option:: lev:axis

   Identifies the axis :literal:`(X,Y,Z,T)` corresponding to this
   coordinate vector.  Set this to :literal:`Z`. 

.. option:: lev:positive

   Specifies the direction in which the vertical dimension is indexed.
   Set this to one of these values: 

   - :literal:`"up"` (Level 1 is the surface, and level
     indices increase upwards)
   - :literal:`"down"` (Level 1 is the atmosphere top, and level
     indices increase downwards)

   For emisisons and most other data sets, you can set
   :option:`lev:positive` to :literal:`"up"`.

   .. important::

      GCHP and the NASA GEOS-ESM use a vertical grid where
      :option:`lev:positive` is :literal:`"down"`.

.. _coards-guide-coordvec-lat:
	      
lat
---

A COARDS-compliant :option:`lat` coordinate vector will have these features:

.. code-block:: console

   dimensions:
           lat = 181 ;
   variables:``
           double lat(lat) ;
                   lat:long_name = "Latitude" ;
                   lat:units = "degrees_north" ;
                   lat:axis = "Y" ;

Here, :option:`lat` is an 8-byte floating point (aka
:literal:`REAL*8`) with 181 values.

The :option:`lat` coordinate vector has the following attributes:

.. option:: lat:long_name

   A detailed description of the contents of this array.  Set this to
   :literal:`Latitude`.

.. option:: lat:units
     
   Specifies the units of latitude.  Set this to
   :literal:`degrees_north`.

.. option:: lat:axis

   Identifies the axis :literal:`(X,Y,Z,T)` corresponding to this
   coordinate vector.  Set this to :literal:`Y`. 

.. _coards-guide-coordvec-lat:

lon
---

A COARDS-compliant :option:`lat` coordinate vector will have these features:

.. code-block:: console

   dimensions:
           lon = 360 ; 
   variables:``
           double lon(lon) ;
                   lon:long_name = "Longitude" ;
                   lon:units = "degrees_east" ;
                   lon:axis = "X" ;

Here, :option:``lon` is an 8-byte floating point (aka
:literal:`REAL*8`) with 360 values.

The :option:`lon` coordinate vector has following attributes:

.. option:: lon:long_name

   A detailed description of the contents of this array.  Set this to
   :literal:`Longitude`.

.. option:: lon:units
     
   Specifies the units of latitude.  Set this to
   :literal:`degrees_east`.
	  
.. option:: lon:axis

   Identifies the axis :literal:`(X,Y,Z,T)` corresponding to this
   coordinate vector.  Set this to :literal:`X`. 
 
Longitudes may be represented modulo 360. For example, -180, 180, and
540 are all valid representations of the International Dateline and 0
and 360 are both valid representations of the Prime Meridian. Note,
however, that the sequence of numerical longitude values stored in the
netCDF file  must be monotonic in a non-modulo sense.
      
Practical guidelines:

#. If your grid begins at the International Dateline (-180°),
   then place  your longitudes into the range -180..180.
#. If your grid begins at the Prime Meridian (0°), then place
   your longitudes into the range 0..360.

.. _coards_data_arrays:

COARDS data arrays
------------------

A COARDS-compliant netCDF file may contain several **data arrays**. In
our example file shown above, there are two data arrays:

| ``dimensions:``
| ``        time = UNLIMITED ; // (12 currently)``
| ``        lev = 72 ;``
| ``        lat = 181 ;``
| ``        lon = 360 ;      ``
| ``variables:``
| ``        float PRPE(time, lev, lat, lon) ;``
| ``                PRPE:long_name = "Propene" ;``
| ``                PRPE:units = "kgC/m2/s" ;``
| ``                PRPE:add_offset = 0.f ;``
| ``                PRPE:scale_factor = 1.f ;``
| ``                PRPE:_FillValue = 1.e+15f ;``
| ``                PRPE:missing_value = 1.e+15f ;``
| ``                PRPE:gamap_category = "ANTHSRCE" ;``
| ``        float CO(time, lev, lat, lon) ;``
| ``                CO:long_name = "CO" ;``
| ``                CO:units = "kg/m2/s" ;                ``
| ``                CO:add_offset = 0.f ;``
| ``                CO:scale_factor = 1.f ;``
| ``                CO:_FillValue = 1.e+15f ;``
| ``                CO:missing_value = 1.e+15f ;``
| ``                CO:gamap_category = "ANTHSRCE" ;``

These arrays contain emissions for GEOS-Chem tracers PRPE (lumped < C3
alkenes) and CO.

Attributes
~~~~~~~~~~

Data arrays in COARDS-compliant netCDF typically use these netCDF
attributes.

+--------------------+-----------------------+-----------------------+
| Attribute          | Type                  | Description           |
+====================+=======================+=======================+
| ``long_name``      | REQUIRED              | Gives a detailed      |
|                    |                       | description of the    |
|                    |                       | contents of the       |
|                    |                       | array.                |
+--------------------+-----------------------+-----------------------+
| ``units``          | REQUIRED              | Specifies the units   |
|                    |                       | in the array. In      |
|                    |                       | general, SI units are |
|                    |                       | preferred.            |
|                    |                       |                       |
|                    |                       | Special usage for     |
|                    |                       | HEMCO:                |
|                    |                       |                       |
|                    |                       | #. Emissions fluxes   |
|                    |                       |                       |
|                    |                       |    -  For species     |
|                    |                       |       such as PRPE    |
|                    |                       |       that are        |
|                    |                       |       tracked as      |
|                    |                       |       equivalent      |
|                    |                       |       carbons, use    |
|                    |                       |       ``kgC/m2/s`` or |
|                    |                       |                       |
|                    |                       |      ``kgC m-2 s-1``. |
|                    |                       |    -  For all other   |
|                    |                       |       species, use    |
|                    |                       |       ``kg/m2/s`` or  |
|                    |                       |       ``kg m-2 s-1``. |
|                    |                       |                       |
|                    |                       | #. Concentration data |
|                    |                       |                       |
|                    |                       |    -  Use ``kg/m3``   |
|                    |                       |       or ``kg m-3``   |
|                    |                       |                       |
|                    |                       | #. Dimensionless data |
|                    |                       |                       |
|                    |                       |    -  Use ``1``.      |
|                    |                       |    -  Do not use      |
|                    |                       |       ``unitless``,   |
|                    |                       |       that is         |
|                    |                       |       non-standard.   |
|                    |                       |       (HEMCO will     |
|                    |                       |       recognize it,   |
|                    |                       |       but it is not   |
|                    |                       |       recommended.)   |
+--------------------+-----------------------+-----------------------+
| ``add_offset``     | OPTIONAL (but         | Specifies an offset   |
|                    | recommended)          | used to store         |
|                    |                       | floating-point data   |
|                    |                       | as packed integer.    |
|                    |                       | Ignored otherwise.    |
|                    |                       |                       |
|                    |                       | -  Set this to ``0``. |
+--------------------+-----------------------+-----------------------+
| ``scale_factor``   | OPTIONAL (but         | Specifies the scale   |
|                    | recommended)          | factor used to store  |
|                    |                       | floating-point data   |
|                    |                       | as packed integer.    |
|                    |                       | Ignored otherwise.    |
|                    |                       |                       |
|                    |                       | -  Set this to ``1``. |
+--------------------+-----------------------+-----------------------+
| ``standard_name``  | OPTIONAL (but         | You may use this      |
|                    | recommended)          | instead of            |
|                    |                       | ``long_name``.        |
+--------------------+-----------------------+-----------------------+
| ``missing_value``  | OPTIONAL (but         | Specifies the value   |
|                    | recommended)          | that represents       |
|                    |                       | missing data. This    |
|                    |                       | should be set to a    |
|                    |                       | number that will not  |
|                    |                       | be mistaken for a     |
|                    |                       | valid data value.     |
|                    |                       | Typical missing data  |
|                    |                       | values are 1e15,      |
|                    |                       | +/-1e32, or +/-1e-32. |
|                    |                       | **NOTE: The           |
|                    |                       | missing_value         |
|                    |                       | attribute should not  |
|                    |                       | exceed the maximum or |
|                    |                       | minimum allowable     |
|                    |                       | value for 4-byte (aka |
|                    |                       | REAL*4) precision     |
|                    |                       | (i.e. ~ +/-1e32 or    |
|                    |                       | +/-1e-32) . This      |
|                    |                       | should avoid floating |
|                    |                       | point errors in HEMCO |
|                    |                       | caused by type        |
|                    |                       | conversion.**         |
+--------------------+-----------------------+-----------------------+
| ``_FillValue``     | OPTIONAL (but         | Synonym for           |
|                    | recommended)          | ``missing_value``. It |
|                    |                       | is recommended to set |
|                    |                       | both                  |
|                    |                       | ``missing_value`` and |
|                    |                       | ``_FillValue``        |
|                    |                       | attributes to the     |
|                    |                       | same value. Some data |
|                    |                       | visualization         |
|                    |                       | packages look for the |
|                    |                       | ``missing_value``     |
|                    |                       | attribute, while      |
|                    |                       | others look for       |
|                    |                       | ``_FillValue``.       |
+--------------------+-----------------------+-----------------------+
| ``gamap_category`` | OPTIONAL              | Specifies the GAMAP   |
|                    |                       | diagnostic category   |
|                    |                       | name. This makes it   |
|                    |                       | easier for the `GAMAP |
|                    |                       | visualization         |
|                    |                       | packag                |
|                    |                       | e <http://acmg.seas.h |
|                    |                       | arvard.edu/gamap/>`__ |
|                    |                       | to read the file.     |
+--------------------+-----------------------+-----------------------+

--`Bob Y. <User:Bmy>`__ (`talk <User_talk:Bmy>`__) 17:56, 1 June 2015
(UTC)

.. _ordering_of_the_data:

Ordering of the data
~~~~~~~~~~~~~~~~~~~~

2D and 3D array variables in netCDF files must have specific dimension
order. If the order is incorrect you will encounter netCDF read error
"start+count exceeds dimension bound". You can check the dimension
ordering of your arrays by using ``ncdump`` with the -h option, e.g.
``ncdump file.nc -h``. Be sure to check the dimensions listed next to
the array name rather than the ordering of the dimensions listed at the
top of the ``ncdump`` output.

The following dimension orders are acceptable:

| ``    array(time,lat,lon)``
| ``    array(time,lat,lon,lev)``

The rest of this section explains why the dimension ordering of arrays
matters.

When you use ``ncdump`` utility to examine the contents of a netCDF
file, you will notice that it displays the dimensions of the data in the
opposite order with respect to Fortran. In our sample file, ``ncdump``
says that the CO and PRPE arrays have these dimensions:

| ``    CO(time,lev,lat,lon)``
| ``    PRPE(time,lev,lat,lon)``

But if you tried to read this netCDF file into GEOS-Chem (or any other
program written in Fortran), you must use data arrays that have these
dimensions:

| ``    CO(lon,lat,lev,time)``
| ``    PRPE(lon,lat,lev,time)``

Here's why:

Fortran is a column-major language, which means that arrays are stored
in memory by columns first, then by rows. If you have declared an arrays
such as:

| ``    INTEGER            :: I, J, L, T``
| ``    INTEGER, PARAMETER :: N_LON  = 360``
| ``    INTEGER, PARAMETER :: N_LAT  = 181``
| ``    INTEGER, PARAMETER :: N_LEV  = 72``
| ``    INTEGER, PARAMTER  :: N_TIME = 12 ``
| ``    REAL*4             :: CO  (N_LON,N_LAT,N_LEV,N_TIME)``
| ``    REAL*4             :: PRPE(N_LON,N_LAT,N_LEV,N_TIME)``

then for optimal efficiency, the leftmost dimension (``I``) needs to
vary the fastest, and needs to be accessed by the innermost DO-loop.
Then the next leftmost dimension (``J``) should be accessed by the next
innermost DO-loop, and so on. Therefore, the proper way to loop over
these arrays is:

| ``    DO T = 1, N_TIME``
| ``    DO L = 1, N_LEV``
| ``    DO J = 1, N_LAT``
| ``    DO I = 1, N_LON``
| ``       CO  (I,J,L,N) = ...``
| ``       PRPE(I,J,L,N) = ...``
| ``    ENDDO``
| ``    ENDDO``
| ``    ENDDO``
| ``    ENDDO``

Note that the ``I`` index is varying most often, since it is the
innermost DO-loop, then ``J``, ``L``, and ``T``. This is opposite to how
a car's odometer reads.

If you loop through an array in this fashion, with leftmost indices
varying fastest, then the code minimizes the number of times it has to
load subsections of the array into cache memory. In this optimal manner
of execution, all of the array elements sitting in the cache memory are
read in the proper order before the next array subsection needs to be
loaded into the cache. But if you step through array elements in the
wrong order, the number of cache loads is proportionally increased.
Because it takes a finite amount of time to reload array elements into
cache memory, the more times you have to access the cache, the longer it
will take the code to execute. This can slow down the code dramatically.

On the other hand, C is a row-major language, which means that arrays
are stored by rows first, then by columns. This means that the outermost
do loop (``I``) is varying the fastest. This is identical to how a car's
odometer reads.

If you use a Fortran program to write data to disk, and then try to read
that data from disk into a program written in C (or NCL), then unless
you reverse the order of the DO loops, you will be reading the array in
the wrong order. In C you would have to use this ordering scheme (using
Fortran-style syntax to illustrate the point):

| ``    DO I = 1, N_LON     ``
| ``    DO J = 1, N_LAT``
| ``    DO L = 1, N_LEV``
| ``    DO T = 1, N_TIME     ``
| ``       CO(T,L,J,I)   = ...``
| ``       PRPE(T,L,J,I) = ...``
| ``    ENDDO``
| ``    ENDDO``
| ``    ENDDO``
| ``    ENDDO``

Because ``ncdump`` is written in C, the order of the array appears
opposite with respect to Fortran. The same goes for any code written in
the NCAR command language (NCL), which is also written in C.

--`Bob Y. <User:Bmy>`__ 17:27, 26 February 2015 (EST)

.. _coards_global_attributes:

COARDS Global attributes
------------------------

**Global attributes** are `netCDF
attributes <https://www.unidata.ucar.edu/software/netcdf/docs/netcdf/Attributes.html>`__
that contain information about a netCDF file, as opposed to information
about an individual data array. `From our example
above <#Examining_the_contents_of_a_netCDF_file>`__, the output from
``ncdump`` showed that our sample netCDF file has several global
attributes:

| ``// global attributes:               ``
| ``               :Title = "COARDS/netCDF file containing X data"``
| ``               :Contact = "GEOS-Chem Support Team (geos-chem-support@as.harvard.edu)" ;``
| ``               :References = "www.geos-chem.org; wiki.geos-chem.org" ;``
| ``               :Conventions = "COARDS" ;``
| ``               :Filename = "my_sample_data_file.1x1"``
| ``               :History = "Mon Mar 17 16:18:09 2014 GMT" ;``
| ``               :ProductionDateTime = "File generated on: Mon Mar 17 16:18:09 2014 GMT" ;``
| ``               :ModificationDateTime = "File generated on: Mon Mar 17 16:18:09 2014 GMT" ;``
| ``               :VersionID = "1.2" ;``
| ``               :Format = "NetCDF-3" ;``
| ``               :Model = "GEOS5" ;``
| ``               :Grid = "GEOS_1x1" ;``
| ``               :Delta_Lon = 1.f ;``
| ``               :Delta_Lat = 1.f ;``
| ``               :SpatialCoverage = "global" ;``
| ``               :NLayers = 72 ;            ``
| ``               :Start_Date = 20050101 ;``
| ``               :Start_Time = 00:00:00.0 ;``
| ``               :End_Date = 20051231 ;``
| ``               :End_Time = 23:59:59.99999 ;``
| ``              ``

You can add as many global attributes as you wish. The following are the
most commonly used:

+----------------------+----------------------+----------------------+
| Attribute            | Type                 | Description          |
+======================+======================+======================+
| ``Title``            | REQUIRED             | Provides a short     |
|                      |                      | description of the   |
|                      |                      | the file.            |
|                      |                      |                      |
|                      |                      | -  If the file was   |
|                      |                      |    converted from    |
|                      |                      |    binary punch      |
|                      |                      |    format by `GAMAP  |
|                      |                      |    routine           |
|                      |                      |    ``BPCH2COARDS`` < |
|                      |                      | http://acmg.seas.har |
|                      |                      | vard.edu/gamap/doc/b |
|                      |                      | y_alphabet/gamap_b.h |
|                      |                      | tml#BPCH2COARDS>`__, |
|                      |                      |    then ``Title``    |
|                      |                      |    will be set to    |
|                      |                      |    `                 |
|                      |                      | `COARDS/netCDF file  |
|                      |                      | created by BPCH2COAR |
|                      |                      | DS (GAMAP v2-17+)``. |
+----------------------+----------------------+----------------------+
| ``Contact``          | OPTIONAL (but        | Provides contact     |
|                      | recommended)         | information about    |
|                      |                      | the person(s) who    |
|                      |                      | created the netCDF   |
|                      |                      | file.                |
+----------------------+----------------------+----------------------+
| ``References``       | OPTIONAL (but        | Provides references  |
|                      | recommended)         | (or links to a web   |
|                      |                      | or wiki page) for    |
|                      |                      | the data contained   |
|                      |                      | in the netCDF file.  |
+----------------------+----------------------+----------------------+
| ``Conventions``      | REQUIRED             | Indicates if the     |
|                      |                      | netCDF file adheres  |
|                      |                      | to a standard (e.g.  |
|                      |                      | COARDS, CF, etc.)    |
|                      |                      |                      |
|                      |                      | -  Set this to       |
|                      |                      |    ``COARDS``.       |
+----------------------+----------------------+----------------------+
| ``Filename``         | OPTIONAL (but        | Specifies the name   |
|                      | recommended)         | of the netCDF file.  |
+----------------------+----------------------+----------------------+
| ``History``          | OPTIONAL (but        | Lists the date of    |
|                      | recommended)         | file creation, and   |
|                      |                      | subsequent dates of  |
|                      |                      | modification.        |
|                      |                      |                      |
|                      |                      | -  If you use the    |
|                      |                      |    netCDF operators  |
|                      |                      |    (NCO) or Climate  |
|                      |                      |    Data Operators    |
|                      |                      |    (CDO) to modify   |
|                      |                      |    the file, the     |
|                      |                      |    ``History``       |
|                      |                      |    attribute will be |
|                      |                      |    modified to       |
|                      |                      |    display the       |
|                      |                      |    commands that     |
|                      |                      |    were used to      |
|                      |                      |    modify the file.  |
+----------------------+----------------------+----------------------+
| ``                   | OPTIONAL (but        | Specifies the date   |
| ProductionDateTime`` | recommended)         | and time on which    |
|                      |                      | the file was         |
|                      |                      | originally created.  |
+----------------------+----------------------+----------------------+
| ``Mo                 | OPTIONAL (but        | Specifies the dates  |
| dificationDateTime`` | recommended)         | and times on which   |
|                      |                      | the file was         |
|                      |                      | modified.            |
+----------------------+----------------------+----------------------+
| ``VersionID``        | OPTIONAL (but        | Specifies a version  |
|                      | recommended)         | number corresponding |
|                      |                      | to the data in the   |
|                      |                      | netCDF file.         |
|                      |                      |                      |
|                      |                      | -  For example, GMAO |
|                      |                      |    met field files   |
|                      |                      |    use this          |
|                      |                      |    attribute to      |
|                      |                      |    denote the        |
|                      |                      |    version number of |
|                      |                      |    the GEOS-DAS      |
|                      |                      |    system (e.g.      |
|                      |                      |    5.7.2, 5.13.1)    |
|                      |                      |    that was used to  |
|                      |                      |    create the data.  |
+----------------------+----------------------+----------------------+
| ``Format``           | OPTIONAL (but        | Specifies the format |
|                      | recommended)         | of the netCDF file.  |
|                      |                      | Possible options     |
|                      |                      | are:                 |
|                      |                      |                      |
|                      |                      | -  ``NetCDF-3``      |
|                      |                      | -  ``NetCDF-4``      |
+----------------------+----------------------+----------------------+
| ``Model``            | OPTIONAL             | Specifies the        |
|                      |                      | vertical grid (e.g.  |
|                      |                      | GEOS-5, MERRA,       |
|                      |                      | GEOS-FP) of the      |
|                      |                      | GEOS-Chem simulation |
|                      |                      | that was used to     |
|                      |                      | generate this data.  |
|                      |                      |                      |
|                      |                      | -  This attribute is |
|                      |                      |    added by GAMAP    |
|                      |                      |    routine           |
|                      |                      |    ``BPCH2COARDS``.  |
|                      |                      | -  For GMAO met      |
|                      |                      |    field data, this  |
|                      |                      |    indicates the     |
|                      |                      |    version of the    |
|                      |                      |    (e.g. ``GEOS-5``) |
|                      |                      |    used to           |
|                      |                      |    assimilate the    |
|                      |                      |    data.             |
+----------------------+----------------------+----------------------+
| ``Delta_Lat``        | OPTIONAL             | Specifies the        |
|                      |                      | spacing between      |
|                      |                      | points along the     |
|                      |                      | longitude axis.      |
|                      |                      |                      |
|                      |                      | -  This attribute is |
|                      |                      |    added by GAMAP    |
|                      |                      |    routine           |
|                      |                      |    ``BPCH2COARDS``.  |
+----------------------+----------------------+----------------------+
| ``Delta_Lon``        | OPTIONAL             | Specifies the        |
|                      |                      | spacing between      |
|                      |                      | points along the     |
|                      |                      | longitude axis.      |
|                      |                      |                      |
|                      |                      | -  This attribute is |
|                      |                      |    added by GAMAP    |
|                      |                      |    routine           |
|                      |                      |    ``BPCH2COARDS``.  |
+----------------------+----------------------+----------------------+
| ``SpatialCoverage``  | OPTIONAL             | Specifies the        |
|                      |                      | horizontal extent of |
|                      |                      | the data. Possible   |
|                      |                      | values are:          |
|                      |                      |                      |
|                      |                      | -  ``global``        |
|                      |                      | -  ``regional``      |
+----------------------+----------------------+----------------------+
| ``NLayers``          | OPTIONAL             | Specifies the number |
|                      |                      | of vertical levels   |
|                      |                      | in the grid.         |
|                      |                      |                      |
|                      |                      | -  This attribute is |
|                      |                      |    added by GAMAP    |
|                      |                      |    routine           |
|                      |                      |    ``BPCH2COARDS``.  |
|                      |                      | -  If the file       |
|                      |                      |    contains only     |
|                      |                      |    surface data,     |
|                      |                      |    then              |
|                      |                      |    ``BPCH2COARDS``   |
|                      |                      |    sets ``NLayers``  |
|                      |                      |    to 1.             |
|                      |                      | -  Sometimes you     |
|                      |                      |    will see this     |
|                      |                      |    attribute named   |
|                      |                      |    ``Nlayers``.      |
+----------------------+----------------------+----------------------+
| ``Start_Date``       | OPTIONAL             | Specifies the        |
|                      |                      | starting date of the |
|                      |                      | data in the file.    |
|                      |                      |                      |
|                      |                      | -  This attribute is |
|                      |                      |    added by GAMAP    |
|                      |                      |    routine           |
|                      |                      |    ``BPCH2COARDS``.  |
|                      |                      | -  You can also      |
|                      |                      |    manually add this |
|                      |                      |    attribute.        |
+----------------------+----------------------+----------------------+
| ``End_Date``         | OPTIONAL             | Specifies the ending |
|                      |                      | date of the data in  |
|                      |                      | the file.            |
|                      |                      |                      |
|                      |                      | -  This attribute is |
|                      |                      |    added by GAMAP    |
|                      |                      |    routine           |
|                      |                      |    ``BPCH2COARDS``.  |
|                      |                      | -  You can also      |
|                      |                      |    manually add this |
|                      |                      |    attribute.        |
+----------------------+----------------------+----------------------+
| ``Start_Time``       | OPTIONAL             | Specifies the        |
|                      |                      | starting date of the |
|                      |                      | data in the file.    |
|                      |                      |                      |
|                      |                      | -  This attribute is |
|                      |                      |    added by GAMAP    |
|                      |                      |    routine           |
|                      |                      |    ``BPCH2COARDS``.  |
|                      |                      | -  You can also      |
|                      |                      |    manually add this |
|                      |                      |    attribute.        |
|                      |                      | -  This attribute    |
|                      |                      |    often has the     |
|                      |                      |    value of          |
|                      |                      |    ``00:00:00.0``.   |
+----------------------+----------------------+----------------------+
| ``End_Date``         | OPTIONAL             | Specifies the ending |
|                      |                      | date of the data in  |
|                      |                      | the file.            |
|                      |                      |                      |
|                      |                      | -  This attribute is |
|                      |                      |    added by GAMAP    |
|                      |                      |    routine           |
|                      |                      |    ``BPCH2COARDS``.  |
|                      |                      | -  You can also      |
|                      |                      |    manually add this |
|                      |                      |    attribute.        |
|                      |                      | -  This attribute    |
|                      |                      |    often has the     |
|                      |                      |    value of          |
|                      |                      |    ``23:59:59.9``.   |
+----------------------+----------------------+----------------------+

--`Bob Y. <User:Bmy>`__ 12:52, 3 March 2015 (EST)

.. _more_about_netcdf_files:

More about netCDF files
-----------------------

Here we provide some useful information about working with netCDF data
files. We also invite you to visit `our Working with netCDF data files
wiki page <Working_with_netCDF_data_files>`__.

.. _converting_files_from_binary_punch_format_to_netcdf:

Converting files from binary punch format to netCDF
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This section has been moved to `our Working with netCDF data files wiki
page <Working_with_netCDF_data_files#Converting_files_from_binary_punch_format_to_netCDF>`__.

--`Bob Yantosca <User:Bmy>`__ (`talk <User_talk:Bmy>`__) 21:35, 29
November 2018 (UTC)

.. _chunking_and_deflating_the_netcdf_file_to_improve_io:

Chunking and deflating the netCDF file to improve I/O
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This section has been moved to `our Working with netCDF data files wiki
page <Working_with_netCDF_data_files#Chunking_and_deflating_a_netCDF_file_to_improve_I.2FO>`__.

--`Bob Yantosca <User:Bmy>`__ (`talk <User_talk:Bmy>`__) 20:52, 29
November 2018 (UTC)

.. _script_for_determining_if_a_netcdf_file_is_coards_compliant:

Script for determining if a netCDF file is COARDS-compliant
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\ **The ``isCoards`` script now ships with\ **\ `GEOS-Chem
v11-01 <GEOS-Chem_v11-01>`__\ **\ and higher versions.**\ 

The `GEOS-Chem Support Team <GEOS-Chem_Support_Team>`__ has created a
script named ``isCoards`` that will let you easily determine if a netCDF
file is COARDS-compliant. For more information about how to use this
script, please see `this section of our Working with netCDF data files
wiki
page <Working_with_netCDF_data_files#Determining_if_a_netCDF_file_is_COARDS-compliant>`__.

--`Bob Yantosca <User:Bmy>`__ (`talk <User_talk:Bmy>`__) 21:20, 29
November 2018 (UTC)

.. _vertical_coordinates_in_netcdf_files_produced_by_geos_chem:

Vertical coordinates in netCDF files produced by GEOS-Chem
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

For more information about the vertical coordinate variables contained
in netCDF output files produced by GEOS-Chem, please see `Vertical
coordinates in netCDF
files <List_of_diagnostics_archived_to_netCDF_format#Vertical_coordinates_in_netCDF_files>`__,
which is found on the section of the *List of diagnostics archived to
netCDF format* wiki page.

--`Bob Yantosca <User:Bmy>`__ (`talk <User_talk:Bmy>`__) 15:37, 4
December 2018 (UTC)

.. _required_information_when_submitting_data_to_the_hemco_data_repository:

Required information when submitting data to the HEMCO data repository
----------------------------------------------------------------------

If you are submitting an new emissions inventory or atmospheric data set
for inclusion into the `standard HEMCO data
repository <HEMCO_data_directories>`__, then please see our `Guidelines
for submitting code and data updates for
GEOS-Chem <GEOS-Chem_coding_and_debugging#Submitting_updates_for_inclusion_into_GEOS-Chem>`__.

Also make sure that your netCDF data files:

#. `adhere to the COARDS
   standard <Working_with_netCDF_data_files#Determining_if_a_netCDF_file_is_COARDS-compliant>`__,
#. `have been chunked and deflated
   accordingly <Working_with_netCDF_data_files#Chunking_and_deflating_a_netCDF_file_to_improve_I.2FO>`__,
   and
#. are accompanied by the relevant documentation specified in the
   guidelines mentioned above.

--`Bob Yantosca <User:Bmy>`__ (`talk <User_talk:Bmy>`__) 22:13, 29
November 2018 (UTC)
